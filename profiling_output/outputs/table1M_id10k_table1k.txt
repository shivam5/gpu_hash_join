Generating NSight report...
ncu --metrics sm__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.sum,gpu__compute_memory_throughput.avg.pct_of_peak_sustained_elapsed,gpc__cycles_elapsed.max,l1tex__throughput.avg.pct_of_peak_sustained_active,lts__throughput.avg.pct_of_peak_sustained_elapsed,gpu__dram_throughput.avg.pct_of_peak_sustained_elapsed,launch__waves_per_multiprocessor,sm__inst_executed_pipe_tensor_op_dmma,sm__inst_executed_pipe_tensor_op_gmma,sm__inst_executed_pipe_tensor_op_hmma,sm__inst_executed_pipe_tensor_op_hmma_type_hfma2,sm__inst_executed_pipe_tensor_op_imma,l1tex__t_sector_hit_rate.pct,lts__t_sector_hit_rate.pct,sm__memory_throughput.avg.pct_of_peak_sustained_elapsed,smsp__sass_inst_executed_op_memory_8b.sum,smsp__sass_inst_executed_op_memory_16b.sum,smsp__sass_inst_executed_op_memory_32b.sum,smsp__sass_inst_executed_op_memory_64b.sum,smsp__sass_inst_executed_op_memory_128b.sum,l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum,l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum,l1tex__t_sectors_pipe_lsu_mem_local_op_ld.sum,l1tex__t_sectors_pipe_lsu_mem_local_op_st.sum,l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum,l1tex__t_requests_pipe_lsu_mem_global_op_st.sum,l1tex__t_requests_pipe_lsu_mem_local_op_ld.sum,l1tex__t_requests_pipe_lsu_mem_local_op_st.sum,lts__t_sectors_srcunit_tex_op_read.sum,lts__t_sectors_srcunit_tex_op_write.sum,lts__t_requests_srcunit_tex_op_read.sum,lts__t_requests_srcunit_tex_op_write.sum,lts__t_sectors_srcunit_tex_op_read_lookup_hit.sum,lts__t_sectors_srcunit_tex_op_read_lookup_miss.sum,dram__bytes.sum,smsp__inst_executed.sum,sm__sass_thread_inst_executed_op_integer_pred_on.sum.peak_sustained,smsp__inst_executed.sum,smsp__inst_issued.sum,smsp__inst_executed.avg,smsp__inst_issued.avg,smsp__warps_active.avg.per_cycle_active,smsp__warps_eligible.avg.per_cycle_active,smsp__issue_active.avg.per_cycle_active,smsp__issue_inst0.avg.pct_of_peak_sustained_active,smsp__issue_active.avg.pct_of_peak_sustained_active,smsp__warps_active.avg.peak_sustained,smsp__maximum_warps_avg_per_active_cycle,sm__maximum_warps_per_active_cycle_pct,sm__maximum_warps_avg_per_active_cycle,sm__warps_active.avg.pct_of_peak_sustained_active,sm__warps_active.avg.per_cycle_active,launch__occupancy_limit_registers,launch__occupancy_limit_shared_mem,launch__occupancy_limit_warps,launch__occupancy_limit_blocks,smsp__inst_executed_op_branch.sum,smsp__sass_average_branch_targets_threads_uniform.pct --target-processes all -f -o profiling_output/ncu_metrics/table1M_id10k_table1k.ncu-rep  python src/performance.py --N1 data/table1M_id10k --N2 data/table1k
==PROF== Connected to process 2197769 (/storage/ice1/0/2/klee965/gpu_hash_join/hash_join_env/bin/python3.9)
==PROF== Profiling "elementwise_kernel" - 0: 0%
==WARNING== Backing up device memory in system memory. Kernel replay might be slow. Consider using "--replay-mode application" to avoid memory save-and-restore.
....50%....100% - 13 passes
==PROF== Profiling "matmul_kernel" - 1: 0%....50%....100% - 1 pass

==ERROR== LaunchFailed
==PROF== Trying to shutdown target application
==ERROR== The application returned an error code (9).
==PROF== Report: /storage/ice1/0/2/klee965/gpu_hash_join/profiling_output/ncu_metrics/table1M_id10k_table1k.ncu-rep


Generating text report...
ncu --metrics sm__throughput.avg.pct_of_peak_sustained_elapsed,gpu__time_duration.sum,gpu__compute_memory_throughput.avg.pct_of_peak_sustained_elapsed,gpc__cycles_elapsed.max,l1tex__throughput.avg.pct_of_peak_sustained_active,lts__throughput.avg.pct_of_peak_sustained_elapsed,gpu__dram_throughput.avg.pct_of_peak_sustained_elapsed,launch__waves_per_multiprocessor,sm__inst_executed_pipe_tensor_op_dmma,sm__inst_executed_pipe_tensor_op_gmma,sm__inst_executed_pipe_tensor_op_hmma,sm__inst_executed_pipe_tensor_op_hmma_type_hfma2,sm__inst_executed_pipe_tensor_op_imma,l1tex__t_sector_hit_rate.pct,lts__t_sector_hit_rate.pct,sm__memory_throughput.avg.pct_of_peak_sustained_elapsed,smsp__sass_inst_executed_op_memory_8b.sum,smsp__sass_inst_executed_op_memory_16b.sum,smsp__sass_inst_executed_op_memory_32b.sum,smsp__sass_inst_executed_op_memory_64b.sum,smsp__sass_inst_executed_op_memory_128b.sum,l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum,l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum,l1tex__t_sectors_pipe_lsu_mem_local_op_ld.sum,l1tex__t_sectors_pipe_lsu_mem_local_op_st.sum,l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum,l1tex__t_requests_pipe_lsu_mem_global_op_st.sum,l1tex__t_requests_pipe_lsu_mem_local_op_ld.sum,l1tex__t_requests_pipe_lsu_mem_local_op_st.sum,lts__t_sectors_srcunit_tex_op_read.sum,lts__t_sectors_srcunit_tex_op_write.sum,lts__t_requests_srcunit_tex_op_read.sum,lts__t_requests_srcunit_tex_op_write.sum,lts__t_sectors_srcunit_tex_op_read_lookup_hit.sum,lts__t_sectors_srcunit_tex_op_read_lookup_miss.sum,dram__bytes.sum,smsp__inst_executed.sum,sm__sass_thread_inst_executed_op_integer_pred_on.sum.peak_sustained,smsp__inst_executed.sum,smsp__inst_issued.sum,smsp__inst_executed.avg,smsp__inst_issued.avg,smsp__warps_active.avg.per_cycle_active,smsp__warps_eligible.avg.per_cycle_active,smsp__issue_active.avg.per_cycle_active,smsp__issue_inst0.avg.pct_of_peak_sustained_active,smsp__issue_active.avg.pct_of_peak_sustained_active,smsp__warps_active.avg.peak_sustained,smsp__maximum_warps_avg_per_active_cycle,sm__maximum_warps_per_active_cycle_pct,sm__maximum_warps_avg_per_active_cycle,sm__warps_active.avg.pct_of_peak_sustained_active,sm__warps_active.avg.per_cycle_active,launch__occupancy_limit_registers,launch__occupancy_limit_shared_mem,launch__occupancy_limit_warps,launch__occupancy_limit_blocks,smsp__inst_executed_op_branch.sum,smsp__sass_average_branch_targets_threads_uniform.pct --target-processes all  python src/performance.py --N1 data/table1M_id10k --N2 data/table1k
==PROF== Connected to process 2200210 (/storage/ice1/0/2/klee965/gpu_hash_join/hash_join_env/bin/python3.9)
==PROF== Profiling "elementwise_kernel" - 0: 0%
==WARNING== Backing up device memory in system memory. Kernel replay might be slow. Consider using "--replay-mode application" to avoid memory save-and-restore.
....50%....100% - 13 passes
==PROF== Profiling "matmul_kernel" - 1: 0%....50%....100% - 1 pass

==ERROR== LaunchFailed
==PROF== Trying to shutdown target application
==ERROR== The application returned an error code (9).
[2200210] python3.9@127.0.0.1
  void at::elementwise_kernel<128, 4, void at::gpu_kernel_impl_nocast<at::direct_copy_kernel_cuda(at::TensorIteratorBase &)::[lambda() (instance 3)]::operator ()() const::[lambda() (instance 10)]::operator ()() const::[lambda(c10::Half) (instance 1)]>(at::TensorIteratorBase &, const T1 &)::[lambda(int) (instance 1)]>(int, T3) (19532, 1, 1)x(128, 1, 1), Context 1, Stream 7, Device 0, CC 9.0
    Section: Command line profiler metrics
    ------------------------------------------------------------------- ----------- ------------
    Metric Name                                                         Metric Unit Metric Value
    ------------------------------------------------------------------- ----------- ------------
    dram__bytes.sum                                                           Mbyte        30.10
    gpc__cycles_elapsed.max                                                   cycle      128,625
    gpu__compute_memory_throughput.avg.pct_of_peak_sustained_elapsed              %        94.44
    gpu__dram_throughput.avg.pct_of_peak_sustained_elapsed                        %        11.09
    gpu__time_duration.sum                                                       us        81.02
    l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                                      312,500
    l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                                      312,500
    l1tex__t_requests_pipe_lsu_mem_local_op_ld.sum                                             0
    l1tex__t_requests_pipe_lsu_mem_local_op_st.sum                                             0
    l1tex__t_sector_hit_rate.pct                                                  %         4.21
    l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                           sector   10,000,000
    l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                           sector      621,816
    l1tex__t_sectors_pipe_lsu_mem_local_op_ld.sum                            sector            0
    l1tex__t_sectors_pipe_lsu_mem_local_op_st.sum                            sector            0
    l1tex__throughput.avg.pct_of_peak_sustained_active                            %        58.76
    launch__occupancy_limit_blocks                                            block           32
    launch__occupancy_limit_registers                                         block           21
    launch__occupancy_limit_shared_mem                                        block           32
    launch__occupancy_limit_warps                                             block           16
    launch__waves_per_multiprocessor                                                        9.25
    lts__t_requests_srcunit_tex_op_read.sum                                 request    9,545,881
    lts__t_requests_srcunit_tex_op_write.sum                                request      298,590
    lts__t_sector_hit_rate.pct                                                    %        92.96
    lts__t_sectors_srcunit_tex_op_read.sum                                   sector    9,546,489
    lts__t_sectors_srcunit_tex_op_read_lookup_hit.sum                        sector    9,035,851
    lts__t_sectors_srcunit_tex_op_read_lookup_miss.sum                       sector      985,526
    lts__t_sectors_srcunit_tex_op_write.sum                                  sector      625,000
    lts__throughput.avg.pct_of_peak_sustained_elapsed                             %        94.44
    sm__inst_executed_pipe_tensor_op_dmma.avg                                  inst            0
    sm__inst_executed_pipe_tensor_op_dmma.max                                  inst            0
    sm__inst_executed_pipe_tensor_op_dmma.min                                  inst            0
    sm__inst_executed_pipe_tensor_op_dmma.sum                                  inst            0
    sm__inst_executed_pipe_tensor_op_gmma.avg                                  inst            0
    sm__inst_executed_pipe_tensor_op_gmma.max                                  inst            0
    sm__inst_executed_pipe_tensor_op_gmma.min                                  inst            0
    sm__inst_executed_pipe_tensor_op_gmma.sum                                  inst            0
    sm__inst_executed_pipe_tensor_op_hmma.avg                                  inst     2,367.42
    sm__inst_executed_pipe_tensor_op_hmma.max                                  inst        3,232
    sm__inst_executed_pipe_tensor_op_hmma.min                                  inst        2,048
    sm__inst_executed_pipe_tensor_op_hmma.sum                                  inst      312,500
    sm__inst_executed_pipe_tensor_op_hmma_type_hfma2.avg                       inst     2,367.42
    sm__inst_executed_pipe_tensor_op_hmma_type_hfma2.max                       inst        3,232
    sm__inst_executed_pipe_tensor_op_hmma_type_hfma2.min                       inst        2,048
    sm__inst_executed_pipe_tensor_op_hmma_type_hfma2.sum                       inst      312,500
    sm__inst_executed_pipe_tensor_op_imma.avg                                  inst            0
    sm__inst_executed_pipe_tensor_op_imma.max                                  inst            0
    sm__inst_executed_pipe_tensor_op_imma.min                                  inst            0
    sm__inst_executed_pipe_tensor_op_imma.sum                                  inst            0
    sm__maximum_warps_avg_per_active_cycle                                     warp           64
    sm__maximum_warps_per_active_cycle_pct                                        %          100
    sm__memory_throughput.avg.pct_of_peak_sustained_elapsed                       %         5.61
    sm__sass_thread_inst_executed_op_integer_pred_on.sum.peak_sustained  inst/cycle       16,896
    sm__throughput.avg.pct_of_peak_sustained_elapsed                              %        19.86
    sm__warps_active.avg.pct_of_peak_sustained_active                             %        92.72
    sm__warps_active.avg.per_cycle_active                                      warp        59.34
    smsp__inst_executed.avg                                                    inst    25,449.92
    smsp__inst_executed.sum                                                    inst   13,437,560
    smsp__inst_executed_op_branch.sum                                          inst    1,562,520
    smsp__inst_issued.avg                                                      inst    25,535.93
    smsp__inst_issued.sum                                                      inst   13,482,972
    smsp__issue_active.avg.pct_of_peak_sustained_active                           %        20.64
    smsp__issue_active.avg.per_cycle_active                                                 0.21
    smsp__issue_inst0.avg.pct_of_peak_sustained_active                            %        79.36
    smsp__maximum_warps_avg_per_active_cycle                                   warp           16
    smsp__sass_average_branch_targets_threads_uniform.pct                         %          100
    smsp__sass_inst_executed_op_memory_128b.sum                                inst            0
    smsp__sass_inst_executed_op_memory_16b.sum                                 inst      625,000
    smsp__sass_inst_executed_op_memory_32b.sum                                 inst            0
    smsp__sass_inst_executed_op_memory_64b.sum                                 inst            0
    smsp__sass_inst_executed_op_memory_8b.sum                                  inst            0
    smsp__warps_active.avg.peak_sustained                                      warp           16
    smsp__warps_active.avg.per_cycle_active                                    warp        14.87
    smsp__warps_eligible.avg.per_cycle_active                                  warp         0.27
    ------------------------------------------------------------------- ----------- ------------

  matmul_kernel (0, 0, 0)x(0, 0, 0), Context 1, Stream 7, Device 0, CC 9.0
    Section: Command line profiler metrics
    ------------------------------------------------------------------- ----------- ------------
    Metric Name                                                         Metric Unit Metric Value
    ------------------------------------------------------------------- ----------- ------------
    dram__bytes.sum                                                            byte      (!) nan
    gpc__cycles_elapsed.max                                                   cycle      (!) nan
    gpu__compute_memory_throughput.avg.pct_of_peak_sustained_elapsed              %      (!) nan
    gpu__dram_throughput.avg.pct_of_peak_sustained_elapsed                        %      (!) nan
    gpu__time_duration.sum                                                       ns      (!) nan
    l1tex__t_requests_pipe_lsu_mem_global_op_ld.sum                                      (!) nan
    l1tex__t_requests_pipe_lsu_mem_global_op_st.sum                                      (!) nan
    l1tex__t_requests_pipe_lsu_mem_local_op_ld.sum                                       (!) nan
    l1tex__t_requests_pipe_lsu_mem_local_op_st.sum                                       (!) nan
    l1tex__t_sector_hit_rate.pct                                                  %      (!) nan
    l1tex__t_sectors_pipe_lsu_mem_global_op_ld.sum                           sector      (!) nan
    l1tex__t_sectors_pipe_lsu_mem_global_op_st.sum                           sector      (!) nan
    l1tex__t_sectors_pipe_lsu_mem_local_op_ld.sum                            sector      (!) nan
    l1tex__t_sectors_pipe_lsu_mem_local_op_st.sum                            sector      (!) nan
    l1tex__throughput.avg.pct_of_peak_sustained_active                            %      (!) nan
    launch__occupancy_limit_blocks                                                       (!) n/a
    launch__occupancy_limit_registers                                                    (!) n/a
    launch__occupancy_limit_shared_mem                                                   (!) n/a
    launch__occupancy_limit_warps                                                        (!) n/a
    launch__waves_per_multiprocessor                                                     (!) n/a
    lts__t_requests_srcunit_tex_op_read.sum                                 request      (!) nan
    lts__t_requests_srcunit_tex_op_write.sum                                request      (!) nan
    lts__t_sector_hit_rate.pct                                                    %      (!) nan
    lts__t_sectors_srcunit_tex_op_read.sum                                   sector      (!) nan
    lts__t_sectors_srcunit_tex_op_read_lookup_hit.sum                        sector      (!) nan
    lts__t_sectors_srcunit_tex_op_read_lookup_miss.sum                       sector      (!) nan
    lts__t_sectors_srcunit_tex_op_write.sum                                  sector      (!) nan
    lts__throughput.avg.pct_of_peak_sustained_elapsed                             %      (!) nan
    sm__inst_executed_pipe_tensor_op_dmma.avg                                  inst      (!) nan
    sm__inst_executed_pipe_tensor_op_dmma.max                                  inst      (!) nan
    sm__inst_executed_pipe_tensor_op_dmma.min                                  inst      (!) nan
    sm__inst_executed_pipe_tensor_op_dmma.sum                                  inst      (!) nan
    sm__inst_executed_pipe_tensor_op_gmma.avg                                  inst      (!) nan
    sm__inst_executed_pipe_tensor_op_gmma.max                                  inst      (!) nan
    sm__inst_executed_pipe_tensor_op_gmma.min                                  inst      (!) nan
    sm__inst_executed_pipe_tensor_op_gmma.sum                                  inst      (!) nan
    sm__inst_executed_pipe_tensor_op_hmma.avg                                  inst      (!) nan
    sm__inst_executed_pipe_tensor_op_hmma.max                                  inst      (!) nan
    sm__inst_executed_pipe_tensor_op_hmma.min                                  inst      (!) nan
    sm__inst_executed_pipe_tensor_op_hmma.sum                                  inst      (!) nan
    sm__inst_executed_pipe_tensor_op_hmma_type_hfma2.avg                       inst      (!) nan
    sm__inst_executed_pipe_tensor_op_hmma_type_hfma2.max                       inst      (!) nan
    sm__inst_executed_pipe_tensor_op_hmma_type_hfma2.min                       inst      (!) nan
    sm__inst_executed_pipe_tensor_op_hmma_type_hfma2.sum                       inst      (!) nan
    sm__inst_executed_pipe_tensor_op_imma.avg                                  inst      (!) nan
    sm__inst_executed_pipe_tensor_op_imma.max                                  inst      (!) nan
    sm__inst_executed_pipe_tensor_op_imma.min                                  inst      (!) nan
    sm__inst_executed_pipe_tensor_op_imma.sum                                  inst      (!) nan
    sm__maximum_warps_avg_per_active_cycle                                               (!) n/a
    sm__maximum_warps_per_active_cycle_pct                                               (!) n/a
    sm__memory_throughput.avg.pct_of_peak_sustained_elapsed                       %      (!) nan
    sm__sass_thread_inst_executed_op_integer_pred_on.sum.peak_sustained  inst/cycle            0
    sm__throughput.avg.pct_of_peak_sustained_elapsed                              %      (!) nan
    sm__warps_active.avg.pct_of_peak_sustained_active                             %      (!) nan
    sm__warps_active.avg.per_cycle_active                                      warp      (!) nan
    smsp__inst_executed.avg                                                    inst      (!) nan
    smsp__inst_executed.sum                                                    inst      (!) nan
    smsp__inst_executed_op_branch.sum                                          inst      (!) nan
    smsp__inst_issued.avg                                                      inst      (!) nan
    smsp__inst_issued.sum                                                      inst      (!) nan
    smsp__issue_active.avg.pct_of_peak_sustained_active                           %      (!) nan
    smsp__issue_active.avg.per_cycle_active                                              (!) nan
    smsp__issue_inst0.avg.pct_of_peak_sustained_active                            %      (!) nan
    smsp__maximum_warps_avg_per_active_cycle                                   warp            1
    smsp__sass_average_branch_targets_threads_uniform.pct                         %      (!) nan
    smsp__sass_inst_executed_op_memory_128b.sum                                inst      (!) nan
    smsp__sass_inst_executed_op_memory_16b.sum                                 inst      (!) nan
    smsp__sass_inst_executed_op_memory_32b.sum                                 inst      (!) nan
    smsp__sass_inst_executed_op_memory_64b.sum                                 inst      (!) nan
    smsp__sass_inst_executed_op_memory_8b.sum                                  inst      (!) nan
    smsp__warps_active.avg.peak_sustained                                      warp           16
    smsp__warps_active.avg.per_cycle_active                                    warp      (!) nan
    smsp__warps_eligible.avg.per_cycle_active                                  warp      (!) nan
    ------------------------------------------------------------------- ----------- ------------



Outputs generated:
NSight report: profiling_output/ncu_metrics/table1M_id10k_table1k.ncu-rep
